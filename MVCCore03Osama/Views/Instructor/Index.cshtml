@model List<Instructor>
@{
    ViewData["Title"] = "getActiveStudents";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<h1>All Instructors</h1>
<div id="noti" class="alert" style="display:none">
    <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
    <strong>Danger!</strong> Indicates a dangerous or potentially negative action.
</div>

<table class="table" id="insContent">
    <thead>
        <tr>

            <th></th>
            <th>@Html.DisplayNameFor(m => Model[0].Fname)</th>
            <th>@Html.DisplayNameFor(m => Model[0].Lname)</th>
            <th>@Html.DisplayNameFor(m => Model[0].Email)</th>
            <th>@Html.DisplayNameFor(m => Model[0].PhoneNumber)</th>
            <th>Courses</th>
            <th>Actiion</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @{string img = "def.jfif";
                        if (item.ImgName != "def.jfif")
                        {
                            img = item.Email + "/" + item.ImgName;

                        }
                        <img asp-append-version="true" width="40" height="40" style="border-radius: 50%;" src=@("~/Images/" + img) />
                    }

                </td>
                <td>
                    @item.Fname
                </td>
                <td>
                    @item.Lname
                </td>
                <td>
                    @item.Email
                </td>
                <td>
                    @item.PhoneNumber

                </td>

                
                <td>
                    @{ SelectList cousrsList = default;

                        var crss = (List<Course>)ViewBag.FK_Course;
                        var res = crss.Where(c => c.InstructorId == item.Id).ToList();
                        if (res != null)
                        {
                            cousrsList = new SelectList(res, "ID", "Name");
                        }
                    }

                    <select asp-items=@cousrsList class="single-select form-control">
                    </select>
                </td>
                <td>
                    <partial name="BtnGroup" model="@item.Id" />
                </td>
            </tr>
        }
    </tbody>
</table>

<script>
    function getDetails(Insid) {
        $.ajax({
            type: "Get",
            url: '@Url.Action("Detail", "Instructor")',
            contentType: "json",
            data: { id: Insid},
            dataType: "json",
            success: function (Data) {
                console.log(JSON.parse(Data));
                var inst = JSON.parse(Data);

                if (Data) {
                    document.getElementById('fname').innerHTML = inst.Fname;
                    document.getElementById('lname').innerHTML = inst.Lname;
                    document.getElementById('email').innerHTML = inst.Email;
                    //alert('Loaded  Successfuly ');

                    //location.href = "https://localhost:44369/Instructor"
                }
                else alert("not removd", value.value);
            },
            error: function () { alert('A error'); }
        });
    }

    function deleteIns(Insid) {
        $.ajax({
            type: "Get",
            url: '@Url.Action("Delete", "Instructor")',
            contentType: "json",
            data: { id: Insid},
            dataType: "json",
            success: function (Data) {
                console.log(JSON.parse(Data));
                $('#insContent').load(document.URL + ' #insContent');

                document.getElementById("noti").style.display="block";
                setTimeout(function () { document.getElementById("noti").style.display = "none"}, 3000);
                
            },
            error: function (e) { console.log(e) }
        });
    }
</script>


